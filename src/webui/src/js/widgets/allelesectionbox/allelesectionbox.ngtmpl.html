<sectionbox color="purple" collapsed="vm.section.options.collapsed">
<maintitle>
  {{vm.header}}
</maintitle>
<controls>

    <!-- Controls -->
    <section class="line-wrapper" ng-if=vm.controls.length>
      <div class="button" ng-repeat="control in vm.controls">

        <button class="id-igv" ng-if="control == 'igv'" ng-click="vm.showIgv()">Show in IGV</button>
        <button class="id-copy-alamut" ng-if="control == 'copy_alamut'" ng-click="vm.copyAlamut()">Copy to alamut</button>
        <button class="id-classification-outdated" ng-if="control == 'reuse_classification' && vm.isAlleleAssessmentOutdated()" disabled>Classification outdated</button>
        <checkable-button class="id-accept-classification" ng-if="control == 'reuse_classification' && vm.hasExistingAlleleAssessment() && !vm.isAlleleAssessmentOutdated()" show-mark="true" check-model="vm.isAlleleAssessmentReused()" ng-click="vm.toggleReuseAlleleAssessment()" one-way="true">
          Accept classification
          <checked>Classification accepted</checked>
        </checkable-button>
        <checkable-button class="id-mark-technical" show-mark="true" ng-if="control == 'toggle_technical'" check-model="vm.alleleState.classT" ng-click="vm.toggleTechnical()" one-way="true" ng-disabled="vm.alleleState.class2 || vm.alleleState.class1">
          Mark technical
          <checked>Marked technical</checked>
        </checkable-button>
        <checkable-button class="id-mark-class1" show-mark="true" ng-if="control == 'toggle_class1'" check-model="vm.alleleState.class1" ng-click="vm.toggleClass1()" one-way="true" ng-disabled="vm.alleleState.classT || vm.alleleState.class2">
          Mark class 1
          <checked>Marked class 1</checked>
        </checkable-button>
        <checkable-button class="id-mark-class2" show-mark="true" ng-if="control == 'toggle_class2'" check-model="vm.alleleState.class2" ng-click="vm.toggleClass2()" one-way="true" ng-disabled="vm.alleleState.classT || vm.alleleState.class1">
          Mark class 2
          <checked>Marked class 2</checked>
        </checkable-button>
        <button class="id-add-references" ng-click="vm.showAddReferenceModal()" ng-if="control == 'references'">Add references</button>
        <button class="id-add-external" ng-if="control == 'custom_external'" ng-click="vm.showCustomAnnotationModal('external')">Add external DB</button>
        <button class="id-add-prediction" ng-if="control == 'custom_prediction'" ng-click="vm.showCustomAnnotationModal('prediction')">Add prediction</button>
        <button ng-if="control == 'add_reference'" ng-click="vm.showAddReferenceModal()">Add reference</button>
        <button class="id-goto-next" ng-if="control == 'skip_next'" ng-click="vm.onSkip()">Go to next</button>

        <section class="line-wrapper" ng-if="control == 'classification' && !vm.isAlleleAssessmentReused()">
          <button class="id-marked-class1" ng-if="vm.alleleState.class1" ng-click="vm.toggleClass1()">
            <svg id="i-checkmark" class="buttonmark" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
              <path d="M2 20 L12 28 30 4" />
            </svg>
            Marked class 1
          </button>
          <button class="id-marked-class2" ng-if="vm.alleleState.class2" ng-click="vm.toggleClass2()">
            <svg id="i-checkmark" class="buttonmark" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
              <path d="M2 20 L12 28 30 4" />
            </svg>
            Marked class 2
          </button>
          <button class="id-marked-technical" ng-if="vm.alleleState.classT" ng-click="vm.toggleTechnical()">
            <svg id="i-checkmark" class="buttonmark" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
              <path d="M2 20 L12 28 30 4" />
            </svg>
            Marked technical
          </button>
          <div class="dropdown" ng-if="!vm.alleleState.class1 && !vm.alleleState.class2 && !vm.alleleState.classT">
            <select class="id-select-classification" ng-disabled="vm.alleleStatus.reuseAlleleAssessment" ng-model="vm.selected_class" ng-options="o.value as o.name for o in vm.classificationOptions">
              <option value="" selected>Select class</option>
            </select>
          </div>
          <button class="id-set-class" ng-if="!vm.alleleState.class1 && !vm.alleleState.class2 && !vm.alleleState.classT" ng-click="vm.updateClassification()">{{vm.getUpdateText()}}</button>
        </section>
      </div>
    </section>



</controls>

<!-- Comments -->
<top class="comments" ng-if=vm.comments.length>
  <autosize-textarea class="control-comment" ng-disabled="!vm.isEditable()" placeholder="{{comment.placeholder}}" ng-model="comment.model.comment" ng-repeat="comment in vm.comments"></autosize-textarea>
</top>

<contentwrapper>
    <allele-sectionbox-content
      class="sectionbox-content"
      analysis="vm.analysis"
      allele="vm.allele"
      references="vm.references"
      allele-state="vm.alleleState"
      boxes="vm.section.content"
      boxes-options="vm.sectionOptions"
      on-save="vm.onUpdate()"
    ></allele-sectionbox-content>
</contentwrapper>
</sectionbox>
