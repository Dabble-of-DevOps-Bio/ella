# Configuration

::: warning NOTE
This documentation is a work in progress and is incomplete.

Please contact developers for more details.
:::

## ella-cli

Most admin tasks are handled using the command line interface `ella-cli`. It's located in `bin/ella-cli`, but should be available in `$PATH` if you use a Docker image.

## Usergroups

A usergroup defines the configuration for different groups of users. See `src/vardb/testdata/usergroups.json` for examples of different configuration options. To update the user groups, run the following command:

`ella-cli users add_groups <path to usergroups.json>`

This will add new or update existing user groups with the new configurations options.

::: warning NOTE
Usergroup configuration history is currently not tracked in the datamodel, so changes should be tracked externally.
:::

### Usergroups and genepanels

ELLA's current access model revolves around gene panels. The genepanels therefore controls which analysis and variants are available to a given user. It is therefore important that this is configured correctly, and if new gene panels are added to the system, that the configuration is updated accordingly.


## Users

List of users and their data is configured in a json file, e.g. `users.json`.

Example:

```
[
    {
        "username": "testuser1",
        "first_name": "Henrik",
        "last_name": "Ibsen",
        "email": "testuser1@foo.bar",
        "group": "testgroup01"
    }
]
```

To add new or update users, run the following command:

`ella-cli users add_many <path to users.json>`

It will go through all usernames and add the ones that don't exist already. For the existing ones, it will compare the settings and update them accordingly.

::: warning NOTE
User configuration history is currently not tracked in the datamodel, so changes should be tracked externally.
:::

## References

The references table in the database can be populated by a json file generated by ella-cli.

To create this file, gather all the PubMed ids you want to populate and put them in a line separated file. Next, run the following command:

`ella-cli references fetch <path to file with PubMed ids>`

This will create a file named references-YYMMDD.json.

Next, you can load this file in the database by running the following command:

`ella-cli deposit references <path to references-YYMMDD.json>`

This will create or update all the references in the file.


## Gene panels

Everything in ELLA revolves around gene panels, and they're an essential part of the configuration. Note that a gene panel doesn't have to be a targeted panel in the traditional sense, but can include all genes in the exome if desired.

A gene panel includes, among other things, the following:

- A list of transcripts, with associated gene name/id and transcript + exon coordinates
- A list of phenotypes, with associated inheritance pattern

See `src/vardb/testdata/clinicalGenePanels/` for example gene panels and naming conventions. `<PanelName>_<version>.transcripts.csv` and `<PanelName>_<version>.phenotypes.csv` files are required.

To add a new gene panel, run the following command:

`ella-cli deposit genepanel --folder <path to gene panel directory>`

## Filter configurations

See [Technical/Filtering](/technical/filtering.md) for more information on creating filter configurations. Also see examples in `src/vardb/testdata/filterconfigs.json` and it's schema in `src/vardb/datamodel/jsonschemas/filterconfig_v1.json`.

To update the filter configurations, run the following command:

`ella-cli filterconfigs update <path to filterconfigs.json>`
